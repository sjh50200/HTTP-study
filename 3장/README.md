# 3장 - HTTP 메시지

# 주제

HTTP 메시지에 대한 모든 것

- 메시지가 어떻게 흘러가는가
- HTTP 메시지의 세 부분 (시작줄, 헤더, 개체 본문)
- 요청과 응답 메시지의 차이
- 요청 메시지가 지원하는 여러 기능(method)들
- 응답 메시지가 반환하는 여러 상태 코드들
- 여러 HTTP 헤더들은 무슨 일을 하는가

## 3.1 메시지의 흐름

HTTP 메시지는 HTTP 애플리케이션 간에 주고받은 데이터의 블록들.

이 블록들은 메시지의 내용과 의미를 설명하는 텍스트 메타 정보로 시작하고 그 다음에 선택적으로 데이터가 올 수 있음.

‘인바운드', ‘아웃바운드', ‘업스트림', ‘다운스트림'은 메시지의 방향을 의미하는 용어이다.

### 3.1.1 메시지는 원 서버 방향을 인바운드로 하여 송신된다

HTTP는 인바운드와 아웃바운드라는 용어를 트랜잭션 방향을 표현하기 위해 사용한다.

메시지가 원 서버로 향하는 것은 인바운드로 이동하는 것

- 클라이언트 → 프락시들 → 서버 → 프락시들 → 클라이언트
- 흔히 알고 있는 흐름

### 3.1.2 다운스트림으로 흐르는 메시지

HTTP 메시지는 강물과 같이 흐른다. 요청 메시지냐 응답 메시지냐에 관계 없이 모든 메시지는 다운스트림으로 흐름.

## 3.2 메시지의 각 부분

헤더 블록은 속성을, 본문은 데이터를 담고 있다. 본문은 없을 수도 있음.

각 줄은 캐리지 리턴(ASCII 13)과 개행 문자(ASCII 10)로 구성된 두 글자의 줄바꿈 문자열로 끝남.

이 줄바꿈 문자열은 ‘**CRLF**’라고 한다.

*HTTP 명세에 따른다면 줄바꿈 문자열은 CRLF이지만 견고한 애플리케이션이라면 그냥 개행문자도 받아들일 수 있어야 한다.*

### 3.2.1 메시지 문법

모든 HTTP 메시지는 요청 메시지나 응답 메시지로 분류 됨.

- 요청 메시지 형식
    
    <메서드> <요청 URL> <버전>
    
    <헤더>
    
    <엔티티 본문>
    
- 응답 메시지 형식
    
    <버전> <상태 코드> <사유 구절>
    
    <헤더>
    
    <엔터티 본문>
    

---

- 메서드
    - 서버가 리소스에 대해 수행해주길 바라는 동작
    - ‘GET’, ‘HEAD’, ‘POST’와 같이 한 단어로 되어 있다.
- 요청 URL
    - 완전한 URL 혹은 URL의 경로 구성 요소
- 버전
    - 이 메시지에서 사용 중인 HTTP의 버전이다.
    - HTTP/<메이저>.<마이너> - 메이저와 마이너는 정수
- 사유 구절
    - 사람이 이해할 수 있게 설명해주는 짧은 문구
    - 상태 코드 이후부터 줄 바꿈 문자열까지가 사유구절이다.
    - ‘HTTP/1.0 200 NOT OK’와 ‘HTTP/1.0 200 OK’는 사유 구절이 서로 달라보이지만 동등하게 성공을 의미하는 것으로 처리되어야 함
- 헤더들
    - 이름, 콜론(:), 선택적인 공백, 값, CRLF가 순서대로 나타나는 0개 이상의 헤더들.
    - 빈 줄(CRLF)로 끝나 헤더 목록의 끝과 엔터티 본문의 시작을 표시함
- 엔터티 본문
    - 임의의 데이터 블록을 포함
    - 때때로 메시지는 그냥 CRLF로 끝나게 됨.
    - 헤더나 엔터티 본문이 없더라도 HTTP 헤더의 집합은 항상 빈 줄(그냥 CRLF)로 끝나야 한다.
        
        ⇒ 잘 지켜지지 않는 구현체와의 호환을 위해, 마지막 CRLF 없이 끝나는 메시지도 받아들일 수 있어야 한다.
        

### 3.2.2 시작줄

모든 HTTP 메시지는 시작줄로 시작한다. 응답 메시지의 시작줄은 무슨 일이 일어났는지 말해준다.

- 요청줄
    - 요청 메시지는 서버에게 리소스에 대해 무언가를 해달라고 부탁함.
    - 요청줄(시작줄)에는 서버에서 어떤 동작이 일어나야 하는지 설명해주는 메서드와 그 동작에 대한 대상을 지칭하는 요청 URL이 들어 있음.
    - HTTP 버전도 포함된다.
- 응답줄
    - 수행 결과에 대한 상태 정보와 결과 데이터를 클라이언트에게 돌려줌.
    - 응답 메시지의 시작줄 혹은 응답줄에는 응답 메시지에서 쓰인 HTTP의 버전, 숫자로 된 상태 코드, 수행 상태에 대해 설명해주는 사유 구절이 들어 있음.
- 메서드
    - 요청의 시작줄은 메서드로 시작한다.
    - ex) ‘GET/specials/saw-blade.gif HTTP/1.0’
    
    | 메서드 | 설명 | 메시지 본문이 있는가? |
    | --- | --- | --- |
    | GET | 서버에서 어떤 문서를 가져온다. | 없음 |
    | HEAD | 서버에서 어떤 문서에 대해 헤더만 가져온다. | 없음 |
    | POST | 서버가 처리해야 할 데이터를 보낸다. | 있음 |
    | PUT | 서버에 요청 메시지의 본문을 저장한다. | 있음 |
    | TRACE | 메시지가 프락시를 거쳐 서버에 도달하는 과정을 추적한다. | 없음 |
    | OPTIONS | 서버가 어떤 메서드를 수행할 수 있는 지 확인한다. | 없음 |
    | DELETE | 서버에서 문서를 제거한다. | 없음 |
- 상태 코드
    - 클라이언트에게 무엇이 일어났는지를 말해준다.
        
        
        | 전체 범위 | 정의된 범위 | 분류 |
        | --- | --- | --- |
        | 100-199 | 100-101 | 정보 |
        | 200-299 | 200-206 | 성공 |
        | 300-399 | 300-305 | 리다이렉션 |
        | 400-499 | 400-415 | 클라이언트 에러 |
        | 500-500 | 500-505 | 서버 에러 |
- 사유 구절
    - 응답 시작줄의 마지막 구성요소
    - ex) HTTP/1.0 200 OK - 사유 구절은 OK이다.
- 버전 번호
    - HTTP/x.y 형식으로 요청과 응답 메시지 양쪽 모두에 기술됨.